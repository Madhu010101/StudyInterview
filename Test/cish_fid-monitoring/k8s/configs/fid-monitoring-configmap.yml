apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ app_name }}-configmap
  namespace: {{ k8s_project }}
data:
  TZ: "Africa/Johannesburg"
  SPRING_PROFILES_ACTIVE: "{{ k8s_env }}"
#  spring_datasource_url: "{{ lookup('vault', 'secret/db/strings/{{ k8s_env }}/custcache').value }}"
#  spring_flyway_url: "{{ lookup('vault', 'secret/db/strings/{{ k8s_env }}/custcache').value }}"
#  spring_activemq_broker-url: "failover://tcp://activemq.cst-{{ k8s_project }}.svc.cluster.local:61616"
  spring_activemq_app1_url: "{% if k8s_env == "dev" %}failover://tcp://{{ mq_host1 }}:61616{% else %}failover://ssl://{{ mq_host1 }}:61617{% endif %}"
  spring_activemq_app1_jolokia-url: "{% if k8s_env == "dev" %}http://{{ mq_host1 }}:8161/api/jolokia{% else %}https://{{ mq_host1 }}:8161/api/jolokia{% endif %}"
  spring_activemq_app2_url: "{% if k8s_env == "dev" %}failover://tcp://{{ mq_host2 }}:61616{% else %}failover://ssl://{{ mq_host2 }}:61617{% endif %}"
  spring_activemq_app2_jolokia-url: "{% if k8s_env == "dev" %}http://{{ mq_host1 }}:8161/api/jolokia{% else %}https://{{ mq_host1 }}:8161/api/jolokia{% endif %}"
  customer_applicationPropertiesUrl: "https://app-properties.cit-{{ k8s_project }}.fnb.co.za/properties/{appname}"
  customer_applicationResponseCodeUrl: "https://app-properties.cit-{{ k8s_project }}.fnb.co.za/getResponseCodes"
  environment: "{{ k8s_env }}"
  appname: {{ app_name }}
{% if k8s_env == "dev" %}
  APPDYNAMICS_CONTROLLER_HOST_NAME: "{% if k8s_env == 'prod' %}fnb.saas.appdynamics.com{% else %}fnb-dev.saas.appdynamics.com{% endif %}"
  APPDYNAMICS_AGENT_ACCOUNT_NAME: "{% if k8s_env == 'prod' %}fnb{% else %}fnb-dev{% endif %}"
  APPDYNAMICS_AGENT_ACCOUNT_ACCESS_KEY: "{% if k8s_env == 'prod' %}{{ lookup('vault', 'secret/appd/prod/key').value }}{% else %}{{ lookup('vault', 'secret/appd/dev/key').value }}{% endif %}"
  APPDYNAMICS_AGENT_UNIQUE_HOST_ID: "{{ prdct_team }}_{{ k8s_env }}-{{ app_name }}-k8s"
  APPDYNAMICS_AGENT_APPLICATION_NAME: "{{ prdct_team }}_{{ k8s_env }}"
  APPDYNAMICS_AGENT_TIER_NAME: "{{ app_name }}-k8s"
  APPDYNAMICS_AGENT_NODE_NAME: "{{ prdct_team }}_{{ k8s_env }}-{{ app_name }}-k8s"
  APPDYNAMICS_CONTROLLER_PORT: "443"
  APPDYNAMICS_CONTROLLER_SSL_ENABLED: "true"
{% endif %}
{% if k8s_env != "prod" %}
  grafanaserver: "cit-grafana-nprd.fnb.co.za"
{% else %}
  grafanaserver: "cit-grafana-prod.fnb.co.za"
{% endif %}
