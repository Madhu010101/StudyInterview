{
    "key": "40442163-24af-4080-916a-3f8ef848b07f",
    "topic": "za.dev.busobj.firstid.masterentity.1",
    "value": "{\"eventHeader\": {\"correlations\": [{\"correlationName\": \"eventUUID\", \"correlationValue\": \"7e43cccc-bf6a-4394-afd9-e2a2020b29ae\"}], \"eventAction\": \"u\", \"eventArchContext\": \"consume+event\", \"eventDateTime\": \"2023-10-19T16:18:25.572269402+02:00\", \"eventOrigins\": [{\"eventOriginName\": \"za.dev.derived.cuscache.partymastercustomer.1\", \"eventOriginSourceSystemCode\": \"CRE\", \"eventOriginType\": \"topic\"}], \"eventUUID\": \"7e43cccc-bf6a-4394-afd9-e2a2020b29ae\", \"sourceSystemCode\": \"OPM\"}, \"key\": {\"keyCompanyEntpsTypeCode\": \"-2\", \"keyIdentifierEntpsTypeCode\": \"4\", \"keyIdentifierJurisdictionId\": 52, \"keyIdentifierNumber\": \"7e43cccc-bf6a-4394-afd9-e2a2020b29ae\", \"keyIdentifierSystemEntpsTypeCode\": \"OPM\", \"keyJurisdictionCountryEntpsCode\": \"-2\"}, \"party\": {\"container\": null, \"conversationLanguageEntpsTypeCode\": \"-2\", \"correspondenceLanguageEntpsTypeCode\": \"1\", \"homeLanguageEntpsTypeCode\": \"-2\", \"identifications\": [{\"citizenshipCountryEntpsCode\": \"ZA\", \"identificationBarcodeNumber\": null, \"identificationEntpsTypeCode\": \"12\", \"identificationExpiryDate\": \"20990101\", \"identificationIssueDate\": \"19000101\", \"identificationIssuerCountryEntpsCode\": \"ZA\", \"identificationIssuerEntpsTypeCode\": \"2\", \"identificationNames\": null, \"identificationNumber\": \"201011112321\", \"identificationReferenceNumber\": null, \"identificationStatusDate\": null, \"identificationStatusEntpsTypeCode\": \"2\", \"residencyStatusEntpsTypeCode\": \"5\",\"identificationActiveIndicator\": \"Y\", \"primaryIdentificationIndicator\": \"Y\"}, {\"citizenshipCountryEntpsCode\": \"ZA\", \"identificationBarcodeNumber\": null, \"identificationEntpsTypeCode\": \"6\", \"identificationExpiryDate\": \"20350101\", \"identificationIssueDate\": \"19000101\", \"identificationIssuerCountryEntpsCode\": \"ZA\", \"identificationIssuerEntpsTypeCode\": \"2\", \"identificationNames\": null, \"identificationNumber\": \"RF3654123659\", \"identificationReferenceNumber\": null, \"identificationStatusDate\": null, \"identificationStatusEntpsTypeCode\": \"2\", \"residencyStatusEntpsTypeCode\": \"5\",\"identificationActiveIndicator\": \"Y\", \"primaryIdentificationIndicator\": \"Y\"}, {\"citizenshipCountryEntpsCode\": \"ZA\", \"identificationBarcodeNumber\": null, \"identificationEntpsTypeCode\": \"9\", \"identificationExpiryDate\": null, \"identificationIssueDate\": \"19000101\", \"identificationIssuerCountryEntpsCode\": \"ZA\", \"identificationIssuerEntpsTypeCode\": \"2\", \"identificationNames\": null, \"identificationNumber\": \"4965366539\", \"identificationReferenceNumber\": null, \"identificationStatusDate\": null, \"identificationStatusEntpsTypeCode\": \"2\", \"residencyStatusEntpsTypeCode\": \"5\",\"identificationActiveIndicator\": \"Y\", \"primaryIdentificationIndicator\": \"Y\"}], \"identifiers\": [{\"companyEntpsTypeCode\": \"1\", \"identifierEndDate\": null, \"identifierEntpsTypeCode\": \"2\", \"identifierNumber\": \"3252787801\", \"identifierStartDate\": \"20181106\", \"identifierStatusEntpsTypeCode\": \"2\", \"identifierSystemEntpsTypeCode\": \"CIS\", \"jurisdictionCountryEntpsCode\": \"ZA\", \"jurisdictionId\": 1, \"roleEntpsTypeCode\": \"1\"},{\"companyEntpsTypeCode\": \"1\", \"identifierEndDate\": null, \"identifierEntpsTypeCode\": \"2\", \"identifierNumber\": \"150\", \"identifierStartDate\": \"20181106\", \"identifierStatusEntpsTypeCode\": \"4\", \"identifierSystemEntpsTypeCode\": \"CIS\", \"jurisdictionCountryEntpsCode\": \"ZA\", \"jurisdictionId\": 1, \"roleEntpsTypeCode\": \"1\"}], \"individual\": null, \"locations\": [{\"locationActiveIndicator\": \"Y\", \"allArrangementStatementAddressIndicator\": null, \"digitalAddresses\": [], \"emailAddresses\": [], \"geographicAddresses\": [{\"addressEntpsTypeCode\": \"1\", \"addressLine1\": \"F245 first floor\", \"addressLine2\": \"295 Kessel Street\", \"buildingName\": null, \"careOfName\": null, \"cityName\": \"Randburg\", \"complexName\": null, \"countryEntpsCode\": \"ZA\", \"floorNumber\": null, \"postalAreaNumber\": \"2170\", \"stateDistrictProvinceEntpsTypeCode\": \"-1\", \"stateDistrictProvinceName\": \"GAUTENG\", \"streetName\": null, \"streetNumber\": null, \"subAreaName\": null, \"suburbName\": \"Fairland\", \"suiteName\": null, \"unitNumber\": null, \"googlePlusCode\": null}], \"locationEntpsTypeCode\": \"1\", \"locationTag\": \"Fairlands\", \"locationUseEntpsTypeCode\": \"27\", \"telephonicAddresses\": []}, {\"locationActiveIndicator\": \"Y\", \"allArrangementStatementAddressIndicator\": null, \"digitalAddresses\": [], \"emailAddresses\": [], \"geographicAddresses\": [{\"addressEntpsTypeCode\": \"-1\", \"addressLine1\": \"Unit 29\", \"addressLine2\": \"Lloys Ellis Avenue\", \"buildingName\": null, \"careOfName\": null, \"cityName\": \"Johannesburg\", \"complexName\": null, \"countryEntpsCode\": \"ZA\", \"floorNumber\": null, \"postalAreaNumber\": \"2198\", \"stateDistrictProvinceEntpsTypeCode\": \"ZA-GP\", \"stateDistrictProvinceName\": \"GAUTENG\", \"streetName\": null, \"streetNumber\": null, \"subAreaName\": null, \"suburbName\": \"Houghton Estate\", \"suiteName\": null, \"unitNumber\": null, \"googlePlusCode\": null}], \"locationEntpsTypeCode\": \"1\", \"locationTag\": \"Fnb main campus\", \"locationUseEntpsTypeCode\": \"4\", \"telephonicAddresses\": []}, {\"locationActiveIndicator\": \"Y\", \"allArrangementStatementAddressIndicator\": \"Y\", \"digitalAddresses\": [], \"emailAddresses\": [], \"geographicAddresses\": [], \"locationEntpsTypeCode\": \"2\", \"locationTag\": \"\", \"locationUseEntpsTypeCode\": \"16\", \"telephonicAddresses\": [{\"telephoneAreaDailCode\": \"083\", \"telephoneCountryDailCode\": \"+27\", \"telephoneEntpsTypeCode\": \"-2\", \"telephoneExtensionNumber\": null, \"telephoneFullNumber\": null, \"telephoneNumber\": \"111111\"}]}, {\"locationActiveIndicator\": \"Y\", \"allArrangementStatementAddressIndicator\": \"Y\", \"digitalAddresses\": [], \"emailAddresses\": [{\"emailAddress\": \"Wendy95@fnb.co.za\"}], \"geographicAddresses\": [], \"locationEntpsTypeCode\": \"3\", \"locationTag\": \"\", \"locationUseEntpsTypeCode\": \"19\", \"telephonicAddresses\": []}, {\"locationActiveIndicator\": \"Y\", \"allArrangementStatementAddressIndicator\": \"Y\", \"digitalAddresses\": [], \"emailAddresses\": [], \"geographicAddresses\": [], \"locationEntpsTypeCode\": \"2\", \"locationTag\": \"\", \"locationUseEntpsTypeCode\": \"17\", \"telephonicAddresses\": [{\"telephoneAreaDailCode\": \"064\", \"telephoneCountryDailCode\": \"+27\", \"telephoneEntpsTypeCode\": \"-2\", \"telephoneExtensionNumber\": null, \"telephoneFullNumber\": null, \"telephoneNumber\": \"1111111\"}]}, {\"locationActiveIndicator\": \"Y\", \"allArrangementStatementAddressIndicator\": null, \"digitalAddresses\": [], \"emailAddresses\": [], \"geographicAddresses\": [{\"addressEntpsTypeCode\": \"1\", \"addressLine1\": \"\", \"addressLine2\": \"2 Melrose Boulevard\", \"buildingName\": null, \"careOfName\": null, \"cityName\": \"Johannesburg\", \"complexName\": null, \"countryEntpsCode\": \"ZA\", \"floorNumber\": null, \"postalAreaNumber\": \"2196\", \"stateDistrictProvinceEntpsTypeCode\": \"-1\", \"stateDistrictProvinceName\": \"GAUTENG\", \"streetName\": null, \"streetNumber\": null, \"subAreaName\": null, \"suburbName\": \"Melrose North\", \"suiteName\": null, \"unitNumber\": null, \"googlePlusCode\": null}], \"locationEntpsTypeCode\": \"1\", \"locationTag\": \"Wendy physical address1\", \"locationUseEntpsTypeCode\": \"26\", \"telephonicAddresses\": []}, {\"locationActiveIndicator\": \"Y\", \"allArrangementStatementAddressIndicator\": null, \"digitalAddresses\": [], \"emailAddresses\": [], \"geographicAddresses\": [{\"addressEntpsTypeCode\": \"1\", \"addressLine1\": \"17B\", \"addressLine2\": \"17\", \"buildingName\": null, \"careOfName\": null, \"cityName\": \"Johannesburg \", \"complexName\": null, \"countryEntpsCode\": \"ZA\", \"floorNumber\": null, \"postalAreaNumber\": \"2190\", \"stateDistrictProvinceEntpsTypeCode\": \"-1\", \"stateDistrictProvinceName\": \"Gauteng\", \"streetName\": null, \"streetNumber\": null, \"subAreaName\": null, \"suburbName\": \"Midrand\", \"suiteName\": null, \"unitNumber\": null, \"googlePlusCode\": null}], \"locationEntpsTypeCode\": \"1\", \"locationTag\": \"Wendy physical address 2\", \"locationUseEntpsTypeCode\": \"27\", \"telephonicAddresses\": []}], \"name\": \"PARTNERS-RELATIONSHIPS5- WendyOctober2\", \"organisation\": {\"establishedCountryEntpsCode\": \"ZM\", \"establishedDate\": \"20150603\", \"legalResponsibilityIndicator\": null, \"operationCountryEntpsCode\": \"BW\", \"operationStartDate\": \"19990314\", \"organisationEntpsTypeCode\": \"12\", \"organisationStatusDate\": null, \"organisationStatusEntpsTypeCode\": \"-1\", \"organisationClassifications\": [{\"organisationClassificationTypeCode\": \"1\", \"organisationClassificationAttributeName\": \"standardIndustryEntpsTypeCode\", \"organisationClassificationValue\": \"11200\"}, {\"organisationClassificationTypeCode\": \"2\", \"organisationClassificationAttributeName\": \"businessIndustryEntpsTypeCode\", \"organisationClassificationValue\": \"11200008\",\"organisationClassificationActiveIndicator\":null}], \"registeredHeadOfficeCountryEntpsCode\": \"NA\", \"stateOwnedCompanyIndicator\": \"N\", \"taxYearEndMonth\": 12, \"tradingName\": \"RELATIONSHIPS5-EvoWendyOctober2\"}, \"partyCreatedDate\": null, \"partyEntpsTypeCode\": \"01\", \"partyStatusDate\": null, \"partyStatusEntpsTypeCode\": \"2\", \"profileRegistrationName\": null, \"sourcesOfFunds\": [{\"sourceOfFundsAmount\": 0, \"sourceOfFundsDate\": \"20230928\", \"sourceOfFundsEntpsTypeCode\": \"3\"}, {\"sourceOfFundsAmount\": 0, \"sourceOfFundsDate\": null, \"sourceOfFundsEntpsTypeCode\": \"2\"}, {\"sourceOfFundsAmount\": 0, \"sourceOfFundsDate\": null, \"sourceOfFundsEntpsTypeCode\": \"1\"}, {\"sourceOfFundsAmount\": 0, \"sourceOfFundsDate\": null, \"sourceOfFundsEntpsTypeCode\": \"20\"}, {\"sourceOfFundsAmount\": 0, \"sourceOfFundsDate\": null, \"sourceOfFundsEntpsTypeCode\": \"19\"}], \"takeOnAttributes\": [], \"partyClassifications\": [{\"partyClassificationTypeCode\": \"1\", \"partyClassificationAttributeName\": \"depositTakingInstitutionEntpsTypeCode\", \"partyClassificationValue\": \"30\"}]}}"
}



if organisationEntpsTypeCode in ('31', '37', '42', 54) move '11'

else ( --use Category Code to lookup Org Type Source Code
--Get Category from ORG _TP Table
Return distinct ORG_TP. ORG_CAT_TP_CD
where ORG_TP.ORG_ENTPS_TP_CD = organisationEntpsTypeCode
--Use Category from ORG _TP to lookup Org Type Source Code in ORG_CAT_TP table
(return ORG_CAT_TP.ORG_SRC_TP_CD
where ORG_CAT_TP.ORG_CAT_ENTPS_TP_CD = ORG_TP.ORG_CAT_TP_CD
and ORG_CAT_TP.STM_TP_CD = 'CIS'
and ORG_CAT_TP.ORG_SRC_TP_CD is not null)

else (--where Org Type Source Code is not mapped in ORG_CAT_TP table, use ORG_TP table
return ORG_TP.ORG_SRC_TP_CD, 
where ORG_TP.ORG_ENTPS_TP_CD = organisationEntpsTypeCode
and  ORG_TP.CMPNY_ENTPS_TP_CD = (JRSDCTN.JRSDCTN_SRC_TP_CD returned - refer line 55)
and ORG_TP.STM_TP_CD = 'CIS'
and ORG_TP.ORG_SRC_TP_CD is not null)


primaryEmploymentIndicator
nettIncomeAmount
nettIncomeCurrencyEntpsTypeCode
nettIncomeFrequencyEntpsTypeCode
nettIncomePaymentDay
 
sourceOfFundsCurrencyEntpsTypeCode
sourceOfFundsFrequencyEntpsTypeCode
sourceOfFundsPaymentDay
 
primaryIdentificationIndicator